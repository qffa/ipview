{% extends "admin/admin_base.html" %}
{% from "macros.html" import render_modal_form %}


{% block title %}IPView | Site{% endblock %}
{% block site %} class="active"{% endblock %}


{% block modal %}
    <div class="modal fade" id="addSiteDialogBox" tabindex="-1" role="dialg">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            {{ render_modal_form(form, url_for("admin.add_site"), "Add Site") }}
            </div>
        </div>
    </div>
    <div class="modal fade" id="editSiteModal" tabindex="-1" role="dialg">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
            </div>
        </div>
    </div>
{% endblock %}


{% block content %}
    <h1 class="page-header">Site</h1>
    <div class="command-btn">
        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#addSiteDialogBox">Add Site</a>
        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#loadingEffect">Loading</a>
    </div>
	<table class="table table-hover text-nowrap table-condensed">
		<thead>
			<tr>
				<th>Site Name</th>
				<th>Description</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody>
		{% for site in sites %}
			<tr>
				<td><a href="{{ url_for("admin.site_detail", site_id=site.id) }}">{{ site.name }}</a></td>
				<td>{{ site.description }}</td>
				<td>
                    <div class="dropdown">
                        <p class="action" id="dropdownMenu1" data-toggle="dropdown"><span class="caret"></span></p>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                            <li><a onclick="editSite({{ site.id }})" href="#">edit</a></li>
                            <li><a href="{{ url_for("admin.delete_site", site_id=site.id) }}">delete</a></li>
                        </ul>
                    </div>
                </td>
			</tr>
        {% endfor %}
		</tbody>
	</table>
{% endblock %}


{% block script %}
    {{ super() }}
    <script>
        function editSite(siteId) {

        $("#editSiteModal").load("/admin/site/"+siteId+"/edit");
        $("#editSiteModal").modal("show")
        }

    </script>

{% endblock %}
